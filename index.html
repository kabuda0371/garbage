<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Flat Garbage Schedule</title>
<!-- Prevent caching so updates show immediately -->
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
<meta http-equiv="Pragma" content="no-cache" />
<meta http-equiv="Expires" content="0" />

<style>
  :root{
    --bg: #f7f7fb;
    --card: #ffffff;
    --text: #111827;
    --muted: #6b7280;
    --primary: #2563eb;
    --accent: #22c55e;
    --border: #e5e7eb;
    --table-header: #f3f4f6;
    --today: #fff7ed; /* soft amber */
  }
  @media (prefers-color-scheme: dark) {
    :root{
      --bg: #0b1020;
      --card: #12172a;
      --text: #e5e7eb;
      --muted: #9ca3af;
      --primary: #60a5fa;
      --accent: #34d399;
      --border: #1f2937;
      --table-header: #111827;
      --today: #1b263b;
    }
  }
  *{box-sizing:border-box}
  body{
    margin:0; background:var(--bg); color:var(--text);
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    line-height:1.6;
  }
  .wrap{max-width: 900px; margin: 32px auto; padding: 0 20px;}
  .hero{
    position: relative;
    border-radius: 18px;
    padding: 22px 20px 20px 20px;
    background: linear-gradient(135deg, rgba(37,99,235,.10), rgba(34,197,94,.10));
    border:1px solid var(--border);
    box-shadow: 0 12px 24px rgba(0,0,0,.06);
  }
  .hero h1{ margin:0 0 6px; font-size: clamp(22px, 4vw, 28px); display:flex; align-items:center; gap:10px; }
  .badge{display:inline-block; padding:4px 10px; border-radius:999px; font-size:12px; background:var(--card); border:1px solid var(--border); color:var(--muted)}
  .sub{margin:6px 0 0; color:var(--muted)}

  .panel{ margin-top:16px; display:grid; gap:14px; grid-template-columns: 1fr; }
  @media (min-width:720px){ .panel{ grid-template-columns: 1fr 1fr; } }
  .legend, .notice{
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 12px 14px;
  }
  .legend strong{color:var(--text)}
  .muted{color:var(--muted)}

  .table-wrap{
    margin-top:18px;
    background: var(--card);
    border:1px solid var(--border);
    border-radius: 14px;
    overflow: hidden;
    box-shadow: 0 8px 18px rgba(0,0,0,.05);
  }
  table{ width:100%; border-collapse: collapse; }
  thead th{
    background: var(--table-header);
    color: var(--muted);
    font-weight: 600;
    letter-spacing: .02em;
    text-align:left; padding: 12px 14px; border-bottom: 1px solid var(--border);
  }
  tbody td{ padding: 12px 14px; border-bottom: 1px solid var(--border); }
  tbody tr:hover{ background: rgba(37,99,235,.06); }
  tbody tr.is-today{ background: var(--today); }
  tbody tr.is-next{ outline: 2px dashed rgba(37,99,235,.45); outline-offset: -2px; }

  .toolbar{ display:flex; align-items:center; gap:10px; margin-top:14px; flex-wrap: wrap; }
  .pill{ padding:6px 10px; border:1px solid var(--border); background:var(--card); border-radius:999px; font-size: 13px; }
  .right{ margin-left:auto; color:var(--muted); font-size:13px }

  footer{ margin: 18px 0 32px; color: var(--muted); font-size:13px; text-align:center }
  tbody tr.is-past td{ color: var(--muted); }
  /* Highlight language toggle button */
  #lang-btn-floating{cursor:pointer;font-weight:600;background:var(--primary);color:#fff;border-color:var(--primary);transition:0.2s;}
  #lang-btn-floating:hover{opacity:0.9;transform:translateY(-1px);}
  /* Language toggle button ‚Äî clearer & elevated */
  #lang-btn-floating{cursor:pointer;font-weight:700;background:var(--primary);color:#fff;border-color:var(--primary);
    padding:8px 14px;border-radius:999px;box-shadow:0 4px 10px rgba(37,99,235,.25);display:inline-flex;align-items:center;gap:8px}
  #lang-btn-floating:hover{opacity:.95;transform:translateY(-1px)}
  #lang-btn-floating:active{transform:translateY(0)}
  /* Floating position for language toggle */
  #lang-btn-floating{position:fixed;top:16px;right:16px;z-index:1000}
  @media (max-width:480px){#lang-btn-floating{top:12px;right:12px;padding:7px 12px}}
</style>
</head>
<body>
  <!-- Floating language toggle (fixed at top-right) -->
  <button id="lang-btn-floating" type="button" aria-label="Language toggle">üá¨üáß EN</button>
  <div class="wrap">
    <section class="hero">
      <h1><span id="title-emoji">üóëÔ∏è</span> <span id="title-text">Flat Garbage Schedule</span> <span class="badge" id="badge-text">Mon & Thu ‚Ä¢ 6-person rotation</span></h1>
      <p class="sub" id="sub-text">Two people every week: <b>Monday</b> and <b>Thursday</b>. Six people rotate every ~3 weeks.</p>
      <div class="panel">
        <div class="legend">
          <strong id="legend-title">People / letters</strong><br>
          <span class="muted">A ‚Äì Ziteng &nbsp;|&nbsp; B ‚Äì Chenyang &nbsp;|&nbsp; C ‚Äì Peter &nbsp;|&nbsp; D ‚Äì Alice &nbsp;|&nbsp; E ‚Äì Yixiao &nbsp;|&nbsp; F ‚Äì Enzo</span>
        </div>
        <div class="notice">
          <strong id="note-title">Note</strong><br>
          <span class="muted" id="note-text">If you can‚Äôt make your day, please notify in the WhatsApp group üôÇ</span>
        </div>
      </div>

      <div class="toolbar">
        <span class="pill" id="today-pill"><span id="today-pill-label">Today:</span> <span id="today-label">‚Äî</span></span>
        <span class="pill" id="next-pill"><span id="next-pill-label">Next duty:</span> <span id="next-label">‚Äî</span></span>
        
        <span class="right" id="updated"><span id="updated-label">Last updated:</span> <span id="updated-at"></span></span>
      </div>
    </section>

    <div class="table-wrap">
      <table id="schedule">
        <thead>
          <tr><th id="th-date">Date</th><th id="th-weekday">Weekday</th><th id="th-person">Person</th></tr>
        </thead>
        <tbody id="schedule-body">
          <!-- Rows will be generated by JavaScript -->
        </tbody>
      </table>
    </div>

    <footer>
      This page is static (no server). Share as QR or link.
    </footer>
  </div>

<script>
  // ===== I18N + Rendering + Highlighting =====
  const i18n = {
    en: {
      title: 'Flat Garbage Schedule',
      badge: 'Mon & Thu ‚Ä¢ 6-person rotation',
      sub: 'Two people every week: <b>Monday</b> and <b>Thursday</b>. Six people rotate every ~3 weeks.',
      legendTitle: 'People / letters',
      noteTitle: 'Note',
      note: 'If you can‚Äôt make your day, please notify in the WhatsApp group üôÇ',
      columns: { date: 'Date', weekday: 'Weekday', person: 'Person' },
      today: 'Today',
      next: 'Next duty',
      updated: 'Last updated',
      inDays: n => `in ${n} day${n>1?'s':''}`,
      todayWord: 'today',
      locale: 'en-GB'
    },
    de: {
      title: 'M√ºllplan der WG',
      badge: 'Mo & Do ‚Ä¢ Rotation mit 6 Personen',
      sub: 'Jede Woche sind <b>Montag</b> und <b>Donnerstag</b> dran. Sechs Personen rotieren ca. alle 3 Wochen.',
      legendTitle: 'Personen / Buchstaben',
      noteTitle: 'Hinweis',
      note: 'Wenn du an deinem Tag nicht kannst, bitte in der WhatsApp‚ÄëGruppe Bescheid geben üôÇ',
      columns: { date: 'Datum', weekday: 'Wochentag', person: 'Person' },
      today: 'Heute',
      next: 'N√§chster Dienst',
      updated: 'Zuletzt aktualisiert',
      inDays: n => `in ${n} Tag${n>1?'en':''}`,
      todayWord: 'heute',
      locale: 'de-DE'
    }
  };

  // ---- Compact schedule data (edit here) ----
  const scheduleData = [
    { date: '2025-10-20', person: 'Ziteng (A)' },
    { date: '2025-10-23', person: 'Chenyang (B)' },
    { date: '2025-10-27', person: 'Peter (C)' },
    { date: '2025-10-30', person: 'Alice (D)' },
    { date: '2025-11-03', person: 'Yixiao (E)' },
    { date: '2025-11-06', person: 'Enzo (F)' },
    { date: '2025-11-10', person: 'Ziteng (A)' },
    { date: '2025-11-13', person: 'Chenyang (B)' },
    { date: '2025-11-17', person: 'Peter (C)' },
    { date: '2025-11-20', person: 'Alice (D)' },
    { date: '2025-11-24', person: 'Yixiao (E)' },
    { date: '2025-11-27', person: 'Enzo (F)' },
    { date: '2025-12-01', person: 'Ziteng (A)' },
    { date: '2025-12-04', person: 'Chenyang (B)' },
    { date: '2025-12-08', person: 'Peter (C)' },
    { date: '2025-12-11', person: 'Alice (D)' }
  ];

  let lang = localStorage.getItem('lang-pref') || 'en';

  function fmtDate(iso, locale){
    const d = new Date(iso + 'T00:00:00');
    return new Intl.DateTimeFormat(locale, { month: 'short', day: 'numeric' }).format(d);
  }
  function fmtWeekday(iso, locale){
    const d = new Date(iso + 'T00:00:00');
    return new Intl.DateTimeFormat(locale, { weekday: 'long' }).format(d);
  }

  function renderTable(){
    const tbody = document.getElementById('schedule-body');
    tbody.innerHTML = '';
    scheduleData.forEach(({date, person}) => {
      const tr = document.createElement('tr');
      tr.setAttribute('data-date', date);
      tr.setAttribute('data-person', person);
      tr.innerHTML = `<td>${fmtDate(date, i18n[lang].locale)}</td>`+
                     `<td>${fmtWeekday(date, i18n[lang].locale)}</td>`+
                     `<td>${person}</td>`;
      tbody.appendChild(tr);
    });
  }

  function applyI18n(){
    const t = i18n[lang];
    document.getElementById('title-text').textContent = t.title;
    document.getElementById('badge-text').textContent = t.badge;
    document.getElementById('sub-text').innerHTML = t.sub;
    document.getElementById('legend-title').textContent = t.legendTitle;
    document.getElementById('note-title').textContent = t.noteTitle;
    document.getElementById('note-text').textContent = t.note;

    document.getElementById('th-date').textContent = t.columns.date;
    document.getElementById('th-weekday').textContent = t.columns.weekday;
    document.getElementById('th-person').textContent = t.columns.person;

    document.getElementById('today-pill-label').textContent = t.today + ':';
    document.getElementById('next-pill-label').textContent = t.next + ':';
    document.getElementById('updated-label').textContent = t.updated + ':';

    const flag = lang==='en' ? 'üá¨üáß EN' : 'üá©üá™ DE';
    const btn = document.getElementById('lang-btn-floating');
    btn.innerHTML = flag;
    btn.setAttribute('aria-label', lang==='en' ? 'Switch language' : 'Sprache wechseln');
  }

  function highlightAndSummaries(){
    // Update last updated (keep ISO)
    document.getElementById('updated-at').textContent = new Date().toISOString().slice(0,10);

    const today = new Date();
    const td = new Date(today.getFullYear(), today.getMonth(), today.getDate());
    const rows = Array.from(document.querySelectorAll('#schedule tbody tr'));
    let next = null, todayMatch = null;

    rows.forEach(tr => {
      const iso = tr.getAttribute('data-date');
      if(!iso) return;
      const d = new Date(iso + 'T00:00:00');
      tr.classList.remove('is-today','is-next','is-past');
      if (d.getTime() === td.getTime()) { tr.classList.add('is-today'); todayMatch = tr; }
      if (d < td) tr.classList.add('is-past');
      if (d >= td && !next) next = tr;
    });

    const fmtLine = tr => {
      if(!tr) return '‚Äî';
      const iso = tr.getAttribute('data-date');
      const person = tr.getAttribute('data-person');
      return `${fmtDate(iso, i18n[lang].locale)} ‚Ä¢ ${person}`;
    };

    document.getElementById('today-label').textContent = fmtLine(todayMatch);
    if (next){ next.classList.add('is-next'); }
    document.getElementById('next-label').textContent = fmtLine(next);

    if (next){
      const nd = new Date(next.getAttribute('data-date') + 'T00:00:00');
      const diffDays = Math.round((nd - td) / 86400000);
      const base = document.getElementById('next-label').textContent;
      const suffix = diffDays > 0 ? i18n[lang].inDays(diffDays) : i18n[lang].todayWord;
      document.getElementById('next-label').textContent = `${base} ‚Äî ${suffix}`;
    }
  }

  function rerenderAll(){
    applyI18n();
    renderTable();
    highlightAndSummaries();
  }

  document.getElementById('lang-btn-floating').addEventListener('click', () => {
    lang = (lang === 'en') ? 'de' : 'en';
    localStorage.setItem('lang-pref', lang);
    rerenderAll();
  });

  // Initial render
  rerenderAll();
</script>
</body>
</html>
